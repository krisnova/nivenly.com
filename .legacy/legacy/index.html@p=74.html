<!DOCTYPE html>
<html lang="en-US">
<head>
<script async defer src="https://buttons.github.io/buttons.js"></script>

<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.nivenly.com/xmlrpc.php">
<title>How to set up a HA privately networked Kubernetes cluster in AWS with kops</title>
<link rel='dns-prefetch' href='../nivenly.com/index.html' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Feed" href="feed/index.html" />
<link rel="alternate" type="application/rss+xml" title=" &raquo; Comments Feed" href="comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title=" &raquo; How to set up a HA privately networked Kubernetes cluster in AWS with kops Comments Feed" href="k8s-aws-private-networking/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.nivenly.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.11"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='contact-form-7-css'  href='wp-content/plugins/contact-form-7/includes/css/styles.css@ver=4.8.css' type='text/css' media='all' />
<link rel='stylesheet' id='icomoon-css'  href='wp-content/plugins/kiwi-social-share/assets/vendors/icomoon/style.css@ver=2.0.4.css' type='text/css' media='all' />
<link rel='stylesheet' id='counter-style-css'  href='wp-content/plugins/page-visit-counter/public/css/counter-style.css@ver=4.8.11.css' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='wp-includes/css/dashicons.min.css@ver=4.8.11.css' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='wp-content/plugins/post-views-counter/css/frontend.css@ver=1.2.7.css' type='text/css' media='all' />
<link rel='stylesheet' id='micky-defaultbasic-css'  href='wp-content/themes/micky/style.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='wp-content/themes/micky/assets/css/bootstrap.min.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='wp-content/themes/micky/assets/css/font-awesome.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='line-icons-css'  href='wp-content/themes/micky/assets/css/simple-line-icons.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-select-css'  href='wp-content/themes/micky/assets/css/bootstrape-select.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='animation-css'  href='wp-content/themes/micky/assets/css/animation.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='micky-style-css'  href='wp-content/themes/micky/assets/css/custom-style.css@ver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='micky-responsive-css'  href='wp-content/themes/micky/assets/css/responsive.css@ver=1.css' type='text/css' media='all' />
<style id='micky-responsive-inline-css' type='text/css'>

		.header_top_main .mk_top_navigations ul.menu li a {
			color: ;
		}
		.header_top_main .mk_top_navigations > ul > li.current_page_item > a {
			border-color: ;
		}
		.header_top_main .mk_top_navigations > ul > li > a:hover {
			border-color: ;
		}
</style>
<link rel='stylesheet' id='micky-googlefonts-css'  href='https://fonts.googleapis.com/css?family=Montserrat%3A100%2C200%2C300%2C400%2C500%2C600%2C700%2C800%2C900&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<script type='text/javascript' src='wp-includes/js/jquery/jquery.js@ver=1.12.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/jquery-migrate.min.js@ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pagevisit = {"ajaxurl":"https:\/\/www.nivenly.com\/wp-admin\/admin-ajax.php","pageurl":"https:\/\/www.nivenly.com\/k8s-aws-private-networking"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/page-visit-counter/public/js/custom.js@ver=1.0.0'></script>
<link rel='https://api.w.org/' href='wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Timeout factories' href='index.html@p=40.html' />
<link rel='next' title='Setting up an HA Kubernetes Cluster in AWS with private topology with kops 1.5.1' href='setting-up-a-kubernetes-cluster-in-aws-with-kops-1-5-0/index.html' />
<meta name="generator" content="WordPress 4.8.11" />
<link rel="canonical" href="index.html@p=74.html" />
<link rel='shortlink' href='index.html@p=74.html' />
<link rel="alternate" type="application/json+oembed" href="wp-json/oembed/1.0/embed@url=https%253A%252F%252Fwww.nivenly.com%252Fk8s-aws-private-networking%252F" />
<link rel="alternate" type="text/xml+oembed" href="wp-json/oembed/1.0/embed@url=https%253A%252F%252Fwww.nivenly.com%252Fk8s-aws-private-networking%252F&amp;format=xml" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #ffffff; }
</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="icon" href="wp-content/uploads/2016/11/cropped-imageedit_1_3569246463-32x32.png" sizes="32x32" />
<link rel="icon" href="wp-content/uploads/2016/11/cropped-imageedit_1_3569246463-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="wp-content/uploads/2016/11/cropped-imageedit_1_3569246463-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.nivenly.com/wp-content/uploads/2016/11/cropped-imageedit_1_3569246463-270x270.png" />
</head>
<body class="post-template-default single single-post postid-74 single-format-standard custom-background">
<div class="main_wrapper_cover">
<header>
<div class="wrapper_main header_top_main">
   <div class="container">
    <div class="row">
     <div class="full_width header_navigation">
      <div class="col-sm-3">
	   <div class="mk_logo">
	   		<h1 class="site-title"><a href="../nivenly.com/index.html" rel="home"></a></h1>
	   </div>
	  </div>
      <div class="col-sm-9">   
       <!-- navbar toggle start -->
		  <div class="navbar-header pull-right">
			  <button type="button" class="navbar-toggle navbar_toogle" data-toggle="collapse" data-target="#myNavbar"> 
				<i class="fa fa-list-ul"></i> 
			  </button>
		  </div>
       <!-- navbar toggle end--> 
       <!-- navigation start -->
       <div class="mk_top_navigations">
	   <ul id="menu-header" class="menu"><li id="menu-item-169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-169"><a href="../nivenly.com/index.html">Home</a></li>
<li id="menu-item-469" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-469"><a href="category/go/index.html">Go</a></li>
<li id="menu-item-470" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-470"><a href="category/k8s/index.html">Kubernetes</a></li>
<li id="menu-item-472" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-472"><a href="category/unix/index.html">Unix</a></li>
<li id="menu-item-407" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-407"><a href="https://becomingkris.com">BecomingKris.com</a></li>
<li id="menu-item-595" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-595"><a href="http://cnibook.info">CNI Book</a></li>
</ul>		
        </div>
       <!-- navigation end --> 
      </div>
      <!-- header_navigation_cover --> 
     </div>
    </div>
   </div>
  </div>
  <!--  header navigation end --> 
</header><div class="wrapper_main breadcum_part">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="breadcum_inner main">
				<h3 class="">How to set up a HA privately networked Kubernetes cluster in AWS with kops</h3> 
				</div>
			</div>
		</div>
	</div>
</div>
<div class="wrapper_main Blog_details_section">
	<div class="container">
		<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12">
						<div id="post-74" class="post-74 post type-post status-publish format-standard has-post-thumbnail hentry category-k8s tag-aws tag-cluster tag-deploy tag-install tag-k8s tag-kops tag-kubernetes tag-nat tag-nat-gateway tag-networking tag-private tag-private-networking tag-route-table tag-subnet tag-vpc">
<div class="blog_post_wrapper_main">
      <div class="blog_thumbnail"> 
	  		<img width="600" height="339" src="wp-content/uploads/2016/12/kubernetes-thumb.png" class="attachment-micky-blog-single size-micky-blog-single wp-post-image" alt="" srcset="wp-content/uploads/2016/12/kubernetes-thumb.png 600w, wp-content/uploads/2016/12/kubernetes-thumb-300x170.png 300w" sizes="(max-width: 600px) 100vw, 600px" />	  	  </div>
     </div>
     <div class="blog_desc blog_details_desc">
      <h3>How to set up a HA privately networked Kubernetes cluster in AWS with kops</h3>
		<div class="bottom">
		  <span class="posted-on"> <a href="index.html@p=74.html" rel="bookmark"><time class="entry-date published" datetime="2016-12-07T05:56:58+00:00">December 7, 2016</time><time class="updated" datetime="2017-03-20T01:35:04+00:00">March 20, 2017</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="author/kris/index.html">Kris Nova</a></span></span>		</div>
      <div class="blog_content">
       <h1>This post is DEPRECATED</h1>
<p>Please check out the <a href="setting-up-a-kubernetes-cluster-in-aws-with-kops-1-5-0/index.html">most recent article instead.</a></p>
<h1>What we are building</h1>
<p>In this tutorial we will cover setting up a HA privately networked Kubernetes cluster in AWS with <a href="https://github.com/kubernetes/kops">Kubernetes kops</a>.</p>
<ul>
<li>Fully private VPC, housing utility and private subnets, with hybrid cloud capabilities over VPN</li>
<li>HA (Highly Available) masters spread across availability zones with private subnetting</li>
<li>Nodes spread across availability zones with private subnetting</li>
<li>Routing between subnets with NAT gateways</li>
<li>Elastic Load Balancers in front of the resources for public access</li>
<li>Bastion server for backend SSH access to the instances</li>
</ul>
<h1>Installing kops</h1>
<p><a href="https://github.com/kubernetes/kops">Kubernetes kops</a> is an open source tool that Kubernetes offers that can be used for deploying Kubernetes clusters against different cloud providers. We will be using the tool to help us with the heavy lifting in this tutorial.</p>
<p>Start by installing the most recent version of kops from the master branch.</p>
<pre class="brush: plain; title: ; notranslate" title="">

brew update &amp;&amp; brew install --HEAD kops

</pre>
<p>More information on installing kops can be found <a href="https://github.com/kubernetes/kops#installation">here</a> for our non OS X users.</p>
<h1>Installing kubectl</h1>
<p>We will also be needing a tool called <strong>kubectl</strong>. Think of this as a thin CLI client for the Kubernetes API, similar to the <strong>aws</strong> CLI tool we will be installing next.</p>
<p>You can download the tarball from the <a href="https://github.com/kubernetes/kubernetes/releases/latest">Kubernetes latest release</a> page in github, or follow the official install guide <a href="http://kubernetes.io/docs/user-guide/prereqs/">here</a>.</p>
<pre class="brush: plain; title: ; notranslate" title="">
wget -O https://github.com/kubernetes/kubernetes/releases/download/v1.4.6/kubernetes.tar.gz
sudo cp kubernetes/platforms/darwin/amd64/kubectl /usr/local/bin/kubectl
</pre>
<h1>Setting up your AWS environment</h1>
<h3>Setting up a kops IAM user</h3>
<p>In this example we will be using a dedicated IAM user to use with kops. This user will need basic API security credentials in order to use kops. Create the user and credentials using the AWS console. <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSGettingStartedGuide/AWSCredentials.html">More information.</a></p>
<p>Kubernetes kops uses the official AWS Go SDK, so all we need to do here is set up your system to use the official AWS supported methods of registering security credentials defined <a href="https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials">here</a>. Here is an example using the <code>aws</code> command line tool to set up your security credentials.</p>
<pre class="brush: plain; title: ; notranslate" title="">
brew update &amp;&amp; brew install awscli
aws configure
aws iam list-users
</pre>
<p>We should now be able to pull a list of IAM users from the API, verifying that our credentials are working as expected.</p>
<h3>Setting up DNS for your cluster</h3>
<p>We will need a publicly resolvable domain name for our cluster. So we need to make sure we have a hosted zone setup in Route53. In this example we will be using <strong>nivenly.com</strong> for our example hosted zone.</p>
<pre class="brush: plain; title: ; notranslate" title=""> ID=$(uuidgen) &amp;&amp; aws route53 create-hosted-zone --name nivenly.com --caller-reference $ID </pre>
<h3>Setting up a state store for your cluster</h3>
<p>In this example we will be creating a dedicated S3 bucket for kops to use. This is where kops will store the state of your cluster and the representation of your cluster, and serves as the source of truth for our cluster configuration throughout the process. We will call this <strong>nivenly-com-state-store</strong>. I recommend keeping the creation confined to <strong>us-east-1</strong>, otherwise more input will be needed here.</p>
<pre class="brush: plain; title: ; notranslate" title=""> aws s3api create-bucket --bucket nivenly-com-state-store --region us-east-1 </pre>
<h1>Creating your first cluster</h1>
<h3>Setup your environment for kops</h3>
<p>Okay! We are ready to start creating our first cluster. Lets first set up a few environmental variables to make this process as clean as possible.</p>
<pre class="brush: plain; title: ; notranslate" title="">
export NAME=myfirstcluster.nivenly.com
export KOPS_STATE_STORE=s3://nivenly-com-state-store
</pre>
<p>Note: You don&#8217;t have to use environmental variables here. You can always define the values using the <strong>&#8211;name</strong> and <strong>&#8211;state</strong> flags later.</p>
<h3>Form your create cluster command</h3>
<p>We will need to note which availability zones are available to us. In this example we will be deploying our cluster to the <strong>us-west-1</strong> region.</p>
<pre class="brush: plain; title: ; notranslate" title=""> aws ec2 describe-availability-zones --region us-west-1 </pre>
<p>Lets form our create cluster command. Here we want to define a few things.</p>
<ul>
<li><strong>&#8211;node-count 3 </strong>
<ul>
<li>We want 3 Kubernetes nodes</li>
</ul>
</li>
<li><strong>&#8211;zones us-west-2a,us-west-2b,us-west-2c</strong>
<ul>
<li>We want to run our nodes spread across the 3 availability zones available to our account</li>
<li>This is a CSV list, pulled from the API in the previous request</li>
</ul>
</li>
<li><strong>&#8211;master-zones us-west-2a,us-west-2b,us-west-2c </strong>
<ul>
<li>This will tell kops that we want 3 masters, running in HA in these 3 availability zones</li>
</ul>
</li>
<li><strong>&#8211;dns-zone nivenly.com</strong>
<ul>
<li>We define the DNS hosted zone we created earlier</li>
</ul>
</li>
<li><strong>&#8211;node-size t2.medium</strong>
<ul>
<li>We set our nodes to a defined instance size</li>
</ul>
</li>
<li><strong>&#8211;master-size t2.medium</strong>
<ul>
<li>We set our masters to a slightly larger instance size</li>
</ul>
</li>
<li><strong>&#8211;topology private </strong>
<ul>
<li>We define that we want to use a private network topology with kops</li>
</ul>
</li>
<li><strong>&#8211;networking weave </strong>
<ul>
<li>We tell kops to use Weave for our overlay network</li>
<li>Many thanks to our friends at <a href="https://www.weave.works/">Weave</a> for helping us make this a staple part of our clusters!</li>
</ul>
</li>
<li><strong>&#8211;image </strong><strong>293135079892/k8s-1.4-debian-jessie-amd64-hvm-ebs-2016-11-16</strong>
<ul>
<li>This is required as a temporary workaround until kops <strong>1.4.2</strong> is released (Estimated Dec 17, 2016)</li>
</ul>
</li>
</ul>
<p>Kops will default to <strong>~/.ssh/id_rsa.pub</strong> for backend access. You can override this with <strong><span class="s1">&#8211;ssh-public-key /path/to/key.pub</span></strong></p>
<pre class="brush: plain; title: ; notranslate" title="">
kops create cluster \
    --node-count 3 \
    --zones us-west-2a,us-west-2b,us-west-2c \
    --master-zones us-west-2a,us-west-2b,us-west-2c \
    --dns-zone nivenly.com \
    --node-size t2.medium \
    --master-size t2.medium \
    --topology private \
    --networking weave \
    --image 293135079892/k8s-1.4-debian-jessie-amd64-hvm-ebs-2016-11-16 \
    ${NAME}
</pre>
<p>kops will deploy these instances using AWS auto scaling groups, so each instance should be ephemeral and will rebuild itself if taken offline for any reason.</p>
<h3>Cluster Configuration</h3>
<p>We now have created the underlying cluster configuration, lets take a look at every aspect that will define our cluster.</p>
<pre class="brush: plain; title: ; notranslate" title=""> kops edit cluster ${NAME} </pre>
<p>This will open up the cluster config (that is actually stored in the S3 bucket we created earlier!) in your favorite text editor. Here is where we can optionally really tweak our cluster for our use case. In this tutorial, we leave it default for now.</p>
<p>For more information on these directives, and the kops API please checkout the kops official <a href="https://github.com/kubernetes/kops/tree/master/docs">documentation</a></p>
<h3>Apply the changes</h3>
<p>Okay, we are ready to create the cluster in AWS. We do so running the following command.</p>
<pre class="brush: plain; title: ; notranslate" title=""> kops update cluster ${NAME} --yes </pre>
<h3>Start using the cluster</h3>
<p>The resources will be deployed asynchronously here. So even though kops has finished, that does not mean our cluster is built. A great way to check if the cluster is online, and the API is working is to use <strong>kubectl</strong></p>
<pre class="brush: plain; title: ; notranslate" title=""> kubectl get nodes </pre>
<p>After we verify the API is responding, we can now use the Kubernetes cluster.</p>
<h3>Backend SSH access</h3>
<p>We should also now have a bastion server behind an elastic load balancer in AWS that will give us access to the cluster over SSH. Grab the bastion ELB A record, and the instance private IP you want to access from the AWS console and SSH into the bastion as follows.</p>
<pre class="brush: plain; title: ; notranslate" title=""> 
ssh -A admin@&lt;bastion_elb_a_record&gt;
ssh admin@&lt;instance_private_ip&gt;
</pre>
<h3>What do you think?</h3>
<p>I always love comments, and suggestions on how to be better. Let me know your thoughts, if you have any good ones.</p>
<p>I wrote a lot of the code for the features in this article, feel free to hit me up on github if you want to follow along!</p>
<p><a class="github-button" href="https://github.com/kris-nova" data-style="mega" data-count-href="/kris-nova/followers" data-count-api="/users/kris-nova#followers" data-count-aria-label="# followers on GitHub">Follow @kris-nova</a></p>
<div class="post-views post-74 entry-meta">
			<span class="post-views-icon dashicons dashicons-chart-bar"></span>
			<span class="post-views-label">Post Views: </span>
			<span class="post-views-count">35,215</span>
			</div>       </div>
      </div>
</div><!-- #post-## -->
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="index.html@p=40.html" rel="prev">Timeout factories</a></div><div class="nav-next"><a href="setting-up-a-kubernetes-cluster-in-aws-with-kops-1-5-0/index.html" rel="next">Setting up an HA Kubernetes Cluster in AWS with private topology with kops 1.5.1</a></div></div>
	</nav>				<div class="blog_desc blog_details_desc">
				<div class="blog_content">
				<div class="comment_section blog_content_inner">
<div id="comments" class="comments-area">
<h3 class="blog-title">LEAVE A COMMENT</h3>
<div class="comment_layer">
	<div class="pull_left"> <span>11 comments</span></div>
</div>
	
				<div class="micky_blog_comment">
		<ol class="comment-list comment">
				<li class="comment even thread-even depth-1 parent" id="comment-6">
		<div id="div-comment-6" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/c97c1b152e50f7a75ddf0832233e0655?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c97c1b152e50f7a75ddf0832233e0655?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>lawrence</h5> 
				  <span class="comment_date"><a>December 15, 2016</a></span>
				  <span class="comment_time">08:42:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=6.html#respond' onclick='return addComment.moveForm( "div-comment-6", "6", "respond", "74" )' aria-label='Reply to lawrence'>Reply</a>				 </div>
				 		
				<p>This is cool.<br />
Yesterday you guys released 1.4.3 still need to use &#8220;–image 293135079892/k8s-1.4-debian-jessie-amd64-hvm-ebs-2016-11-16&#8221; ?<br />
Thanks!</p>
			</div>
		</div>
		
		</div>
		<ul class="children">
	<li class="comment byuser comment-author-kris bypostauthor odd alt depth-2 parent" id="comment-7">
		<div id="div-comment-7" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Kris Nova</h5> 
				  <span class="comment_date"><a>December 18, 2016</a></span>
				  <span class="comment_time">04:03:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=7.html#respond' onclick='return addComment.moveForm( "div-comment-7", "7", "respond", "74" )' aria-label='Reply to Kris Nova'>Reply</a>				 </div>
				 		
				<p>Hey Lawernce</p>
<p>Unfortunately the private topology feature hasn&#8217;t made it into an official release, although its scheduled VERY soon. So for now you will need to continue to pass the &#8211;image flag until the feature has made it into a release. </p>
<p>There will be a little PR around the release when it finally drops &#8211; and I will probably get another article out shortly with the newer features.</p>
<p>Hope this helps, and thanks for the feedback. Thanks for using kops!</p>
			</div>
		</div>
		
		</div>
		<ul class="children">
	<li class="comment even depth-3 parent" id="comment-9">
		<div id="div-comment-9" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/74b93e2536722d35565cf0a9c256ad56?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/74b93e2536722d35565cf0a9c256ad56?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Sonny</h5> 
				  <span class="comment_date"><a>January 10, 2017</a></span>
				  <span class="comment_time">20:45:pm</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=9.html#respond' onclick='return addComment.moveForm( "div-comment-9", "9", "respond", "74" )' aria-label='Reply to Sonny'>Reply</a>				 </div>
				 		
				<p>I&#8217;m trying to use kops version 1.5.0-alpha2.</p>
<p>Is the image &#8220;293135079892/k8s-1.4-debian-jessie-amd64-hvm-ebs-2016-11-16&#8221; still required at this point?</p>
<p>Is it possible for me to use a recent version of CoreOS if I wanted?</p>
			</div>
		</div>
		
		</div>
		<ul class="children">
	<li class="comment byuser comment-author-kris bypostauthor odd alt depth-4" id="comment-12">
		<div id="div-comment-12" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Kris Nova</h5> 
				  <span class="comment_date"><a>January 13, 2017</a></span>
				  <span class="comment_time">05:44:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=12.html#respond' onclick='return addComment.moveForm( "div-comment-12", "12", "respond", "74" )' aria-label='Reply to Kris Nova'>Reply</a>				 </div>
				 		
				<p>The image is no longer required with version 1.5</p>
<p>Feel free to add an issue to the issue tracker and highlight me @kris-nova with any other technical questions</p>
			</div>
		</div>
		
		</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-10">
		<div id="div-comment-10" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/44e566b22615b68af51ec0ec18ce5f39?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44e566b22615b68af51ec0ec18ce5f39?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Jay</h5> 
				  <span class="comment_date"><a>January 11, 2017</a></span>
				  <span class="comment_time">18:57:pm</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=10.html#respond' onclick='return addComment.moveForm( "div-comment-10", "10", "respond", "74" )' aria-label='Reply to Jay'>Reply</a>				 </div>
				 		
				<p>Hi Kris,</p>
<p>Thanks for the great article!  This was very helpful.  Is it possible to use kops to set up a cluster in a VPC that already exists?  If possible ,would you be able to provide any details regarding this option?</p>
			</div>
		</div>
		
		</div>
		<ul class="children">
	<li class="comment byuser comment-author-kris bypostauthor odd alt depth-2" id="comment-13">
		<div id="div-comment-13" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8aaca2ddf0798be312bcb51a3cacff07?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Kris Nova</h5> 
				  <span class="comment_date"><a>January 13, 2017</a></span>
				  <span class="comment_time">05:44:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=13.html#respond' onclick='return addComment.moveForm( "div-comment-13", "13", "respond", "74" )' aria-label='Reply to Kris Nova'>Reply</a>				 </div>
				 		
				<p>Jay,</p>
<p>I think this is the droid you are looking for <a href="https://github.com/kubernetes/kops/blob/master/docs/run_in_existing_vpc.md" rel="nofollow">https://github.com/kubernetes/kops/blob/master/docs/run_in_existing_vpc.md</a></p>
			</div>
		</div>
		
		</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="comment-15">
		<div id="div-comment-15" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/3c0a92c8182942bea978641985331565?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3c0a92c8182942bea978641985331565?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>angelina</h5> 
				  <span class="comment_date"><a>January 18, 2017</a></span>
				  <span class="comment_time">11:23:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=15.html#respond' onclick='return addComment.moveForm( "div-comment-15", "15", "respond", "74" )' aria-label='Reply to angelina'>Reply</a>				 </div>
				 		
				<p>very Informative, preparing for AWS certification, recently joined in kernelTraining.com for AWS tutorial, can any one suggest me some books and videos.</p>
			</div>
		</div>
		
		</div>
		</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-16">
		<div id="div-comment-16" class="">
			
		<div class="micky_comment_main">
			<div class="blog_avtar"> 
				<img alt='' src='https://secure.gravatar.com/avatar/7a376378a96ea9ef58a18486a3eff6b1?s=70&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a376378a96ea9ef58a18486a3eff6b1?s=140&amp;d=mm&amp;r=g 2x' class='avatar avatar-70 photo' height='70' width='70' />			</div>
			<div class="micky_comment_data">
				<div class="author_title">
				  <h5>Daniel Chavero</h5> 
				  <span class="comment_date"><a>February 2, 2017</a></span>
				  <span class="comment_time">10:30:am</span>
				  <a rel='nofollow' class='comment-reply-link' href='k8s-aws-private-networking/index.html@replytocom=16.html#respond' onclick='return addComment.moveForm( "div-comment-16", "16", "respond", "74" )' aria-label='Reply to Daniel Chavero'>Reply</a>				 </div>
				 		
				<p>Hi Kris,</p>
<p>Thank you very much for this article, it has been very useful for me.  I only have a question about to upgrade the cluster to use Kubernetes 1.5.0, I need it in order to use cronJobs, that I guess there are some issues with the version 1.4.7 of Kubernetes.</p>
			</div>
		</div>
		
		</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->
		</div>

			<div class="blog_comments_form">
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.html@p=74.html#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://www.nivenly.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<div class="col-lg-12"><textarea name="comment" rows="3" placeholder="Comment&hellip;" class="comment_textarea"></textarea></div><div class="col-sm-6"><input id="author" name="author" type="text" placeholder="Name&hellip;" value="" class="form-control" size="30" aria-required='true' /></div>
<div class="col-sm-6"><input id="email" name="email" type="email" placeholder="Email&hellip;" value="" class="form-control" size="30" aria-required='true' /></div>
<div class="uncr-g-recaptcha"></div><p class="form-submit"><input name="submit" type="submit" id="comments_button" class="comment_button" value="Send Comment" /> <input type='hidden' name='comment_post_ID' value='74' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="376525e9b0" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="8"/></p>			</form>
			</div><!-- #respond -->
		</div>
</div><!-- #comments -->
</div>				</div>
				</div>
										</div>
					</div>
	</div>
</div>
<footer>
  <div class="wrapper_main footer_section_main">
   <div class="container">
    <div class="row">
     <div class="col-lg-3 col-md-3 col-sm-3">
      <div class="footer_logo"> 
	  		   <h1 style="mk_copy"><a href="../nivenly.com/index.html"></a></h1> 
       	  </div>
     </div>
     <div class="col-lg-6 col-md-6 col-sm-6">
      <p class="footer_copyright">Copyright 2017 Kris Nova <a href="../nivenly.com/index.html"></a></p>
     </div>
     <div class="col-lg-3 col-md-3 col-sm-3">
      <div class="social_icons footer_social">
	  </div>
     </div>
    </div>
   </div>
  </div>
 </footer>
</div>
<script type='text/javascript' src='wp-content/plugins/akismet/_inc/form.js@ver=3.3.2'></script>
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js@ver=3.0.9b'></script>
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js@ver=3.0.9b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://www.nivenly.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://www.nivenly.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeMidnight.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel='stylesheet' id='captcha-style-css'  href='wp-content/plugins/uber-nocaptcha-recaptcha/assets/css/style.css@ver=4.8.11.css' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/www.nivenly.com\/wp-json\/","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}}};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/contact-form-7/includes/js/scripts.js@ver=4.8'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sta_settings = {"distance":"50","speed":"5000","exceptions":""};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/scroll-to-anchor/js/scroll-to-anchor.min.js@ver=4.8.11'></script>
<script type='text/javascript' src='wp-content/themes/micky/assets/js/bootstrap.min.js'></script>
<script type='text/javascript' src='wp-content/themes/micky/assets/js/bootstrap-select-min.js'></script>
<script type='text/javascript' src='wp-content/themes/micky/assets/js/navigation.js@ver=20151215'></script>
<script type='text/javascript' src='wp-content/themes/micky/assets/js/skip-link-focus-fix.js@ver=20151215'></script>
<script type='text/javascript' src='wp-content/themes/micky/assets/js/custom.js'></script>
<script type='text/javascript' src='wp-includes/js/comment-reply.min.js@ver=4.8.11'></script>
<script type='text/javascript' src='wp-includes/js/wp-embed.min.js@ver=4.8.11'></script>
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js?onload=renderUNCRReCaptcha&amp;render=explicit&amp;ver=2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var UNCR = {"site_key":"6LdjjAcUAAAAAOtl-qenrmS-_KhXjvuODKgVRuyS","key_type":"normal","theme":"dark","type":"image","submit_button":"no"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/uber-nocaptcha-recaptcha/assets/js/recaptcha.js@ver=1.0'></script>
</body>
</html>